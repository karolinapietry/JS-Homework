<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Ball hits the wall</title>
  </head>
  <body>
    <div class="container"></div>
  </body>
  <style>
    .box {
      width: 40px;
      height: 40px;
      border: 1px solid grey;
    }
    .wall {
      background: grey;
    }
    .row {
      display: flex;
    }
    .ball {
      background: green;break;
      border-radius: 50%;
    }
  </style>
  <script>

let board = [
       ["X", "X", "X", "X", "X", "X", "X", "X", "X"],
       ["X", "1", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "X", "0", "X", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "0", "0", "0", "0", "0", "0", "0", "X"],
       ["X", "X", "X", "X", "X", "X", "X", "X", "X"]
     ];
     
    let ballCord = [];
    let play = true;
    let timer;
    let NewX = 1;
    let NewY = 1;

    const time = 100;

    const createGameBoard = () => {
      const container = document.querySelector(".container");
      document.querySelector(".container").innerHTML = "";

      const table = document.createElement("div");

      for (let i = 0; i < board.length; i++) {
        const row = document.createElement("div");
        row.setAttribute("class", "row");

        for (let j = 0; j < board[i].length; j++) {
          const box = document.createElement("div");
          box.setAttribute("class", "box");

          switch (board[i][j]) {
            case "X":
                //dodaje klasy do boxów
              box.classList.add("wall");
              break;

            case "1":
              box.classList.add("ball");
              break;

            case "0":
              box.classList.add("empty");
              break;

            default:
              break;
          };
          //zwraca referencję do box na koniec listy row
          row.appendChild(box);
        };
        //zwraca referencję do row na koniec listy table
        table.appendChild(row);
      };
      //zwraca referencję do table na koniec listy container
      container.appendChild(table);
    };


    const findBall = () => {
      for (let i = 0; i < board.length; i++) {
        for (let j = 0; j < board[i].length; j++) {
          if (board[i][j] === "1") {
            ballCord.push([i, j]);
          }
        }
      }
    };

    const changeBallPostion = () => {
      let x = ballCord[0][0];
      let y = ballCord[0][1];

      if(board[x][y+1] === 'X' ){
        NewY = -1;
      }
      if(board[x][y-1] === 'X'){
        NewY = 1;
      }

      if(board[x+1][y] === 'X'){
        NewX = -1;
      }
      if(board[x-1][y] === 'X'){
        NewX = 1;
      }
            
      board[x][y] = '0';       
      board[x + NewX][y + NewY] = '1'; 
      ballCord.splice(0,1);

      if (play) {
        createGameBoard();
        findBall();
        timer = setTimeout(changeBallPostion, time);
      }
    };

    (() => {
      createGameBoard();
      findBall();
      changeBallPostion();
    })();
  </script>
</html>
